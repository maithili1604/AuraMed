<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #ffe6e6; /* Light pink background */
            color: #333; /* Dark gray for text */
        }
        
        .header {
            display: flex;
            flex-direction: column; /* Stack logo and details vertically */
            align-items: center; /* Center logo and name */
            background-color: #009688; /* Teal primary accent */
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .header .logo {
            display: flex;
            flex-direction: column; /* Stack image and name vertically */
            align-items: center; /* Center the logo and name */
        }
        
        .header .logo-img {
            width: 80px;  /* Adjust image size as needed */
            height: auto;  /* Maintain aspect ratio */
            margin-bottom: 10px; /* Space between logo image and name */
        }
        
        .header .logo-name {
            font-size: 24px;
            font-weight: bold;
            color: #ffffff;  /* White color for logo name */
        }
        
        .details {
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* Align items to the left */
            color: white;
            margin-top: 10px; /* Add some space between logo/name and details */
            width: 100%; /* Ensure it takes up the full width */
            padding-left: 20px; /* Add some padding to the left */
        }
        
        .details h1 {
            margin: 0;
            font-size: 20px;
            font-weight: bold;
        }
        
        .details p {
            margin: 5px 0;
        }
        
        .details .edit-btn {
            background-color: #ffcc80; /* Light orange */
            color: #009688;  /* Teal accent for text */
            border: none;
            cursor: pointer;
            padding: 7px 15px;
            border-radius: 5px;
            transition: background-color 0.3s, transform 0.2s;
            align-self: flex-start; /* Align the edit button to the left */
            margin-top: 10px;
        }
        
        .details .edit-btn:hover {
            background-color: #ffb74d; /* Darker orange */
            transform: scale(1.05);
        }
        
        .logout-btn {
            background-color: #ff4d4d; /* Soft red color to signify logout */
            color: white;
            border: none;
            cursor: pointer;
            padding: 10px 20px;
            border-radius: 25px; /* Rounded pill-shaped button */
            font-size: 16px; /* Slightly larger font size for better visibility */
            font-weight: bold; /* Bold font for emphasis */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Add a subtle shadow for depth */
            transition: all 0.3s ease; /* Smooth transition for hover and active states */
            position: absolute; /* Position logout button in the top-right corner */
            top: 15px;
            right: 20px;
        }
        
        .logout-btn:hover {
            background-color: #e60000; /* Slightly darker red for hover effect */
            transform: translateY(-2px) scale(1.05); /* Subtle lift and scaling on hover */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3); /* More pronounced shadow */
        }
        
        .logout-btn:active {
            background-color: #cc0000; /* Even darker red for active state */
            transform: translateY(2px) scale(1); /* Simulates button press */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Reduced shadow for pressed state */
        }
        
        .logout-form {
            display: inline;
        }
        
        
        .content {
            padding: 20px;
        }
        .table-container {
            max-height: 400px; /* Adjust as needed for your layout */
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            background-color: #fff; /* White background for contrast */
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table th, table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            color: #666; /* Medium gray for text */
        }
        table th {
            background-color: #009688; /* Teal for headers */
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0; /* Keeps header visible during scroll */
            z-index: 1;
        }
        table tr:hover td {
            background-color: #f1f1f1; /* Subtle hover effect */
        }
        .action-btn {
            background-color: #009688; /* Teal button */
            color: white;
            border: none;
            cursor: pointer;
            padding: 7px 15px;
            border-radius: 5px;
            transition: background-color 0.3s, transform 0.2s;
        }
        .action-btn:hover {
            background-color: #00796b; /* Darker teal */
            transform: scale(1.05);
        }
        .action-btn:active {
            background-color: #005b4f; /* Even darker teal */
        }

        /* Add modal-specific styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; 
            z-index: 1000; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
        }
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #ccc;
            width: 80%;
            max-width: 500px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .modal-header, .modal-footer {
            padding: 10px;
            background-color: #009688;
            color: white;
            border-radius: 5px;
        }
        .modal-body {
            padding: 10px;
        }
        .close {
            color: white;
            float: right;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
        }
        .dropdown {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .submit-btn {
            background-color: #009688;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        .submit-btn:hover {
            background-color: #00796b;
        }

        /* Additional styles to complement your UI */
    .add-slot-btn {
        background-color: #009688;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin-bottom: 20px;
    }
    .add-slot-btn:hover {
        background-color: #00796b;
    }

    .inv-header {
        text-align: center;
        background-color: #009688;
        color: white;
        padding: 15px;
    }
    
    .inv-add-item-btn {
        background-color: #ffcc80;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    
    .inv-add-item-btn:hover {
        background-color: #ffb74d;
    }
    
    .inv-container {
        padding: 20px;
    }
    
    h2 {
        color: #009688;
    }
    
    .inv-table-container {
        max-height: 400px;
        overflow-y: auto;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: #fff;
        padding: 10px;
    }
    
    .inv-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .inv-table th, .inv-table td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: left;
    }
    
    .inv-table th {
        background-color: #009688;
        color: white;
        position: sticky;
        top: 0;
    }
    
    .inv-edit-btn, .inv-delete-btn {
        padding: 5px 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    
    .inv-edit-btn {
        background-color: #009688;
        color: white;
    }
    
    .inv-edit-btn:hover {
        background-color: #00796b;
    }
    
    .inv-delete-btn {
        background-color: #ff4d4d;
        color: white;
    }
    
    .inv-delete-btn:hover {
        background-color: #cc0000;
    }
    
    /* Modal Styles */
    .inv-modal {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
    }
    
    .inv-modal-content {
        background-color: white;
        margin: 10% auto;
        padding: 20px;
        border: 1px solid #ccc;
        width: 300px;
        border-radius: 10px;
        text-align: center;
    }
    
    .inv-close {
        float: right;
        font-size: 20px;
        cursor: pointer;
    }
    
    .inv-save-btn {
        background-color: #009688;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    
    .inv-save-btn:hover {
        background-color: #00796b;
    }
    /* Search Input Styles */
.search-input {
    width: 100%;
    max-width: 300px;
    padding: 10px 15px;
    margin: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 16px;
    outline: none;
    transition: border-color 0.3s, box-shadow 0.3s;
}

.search-input:focus {
    border-color: #009688;
    box-shadow: 0 0 5px rgba(0, 150, 136, 0.5);
}

.search-input::placeholder {
    color: #888;
    font-style: italic;
}
.tabs-container { display: flex; justify-content: center; align-items: center; background: #009688; padding: 10px; }
        .tabs { display: flex; gap: 15px; justify-content: center; align-items: center; }
        .tab { cursor: pointer; padding: 12px 25px; color: #222; border: none; background: none; font-size: 16px; font-weight: bold; transition: background 0.3s, transform 0.2s; }
        .tab:hover, .tab.active { background: #00796b; border-radius: 8px; transform: scale(1.05); color: white; }
        .tab-content { display: none; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); margin: 20px; color: #222; }
        .tab-content.active { display: block; }
        h2 { color: #005b4f; }

        /* Call Management Styling */
        .call-management-container { padding: 20px; background: #f1f1f1; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); }
        .meeting-section { margin-bottom: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 8px; background: white; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .meeting-section h3 { margin-top: 0; color: #00796b; }
        .meeting-section p { margin: 5px 0; color: #555; }
        .create-room-form { display: none; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); }
        .create-room-form label { display: block; margin-bottom: 10px; color: #333; font-weight: bold; }
        .create-room-form input { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px; }
        .call-button { background: #009688; color: white; border: none; padding: 12px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; transition: background 0.3s, transform 0.2s; font-weight: bold; }
        .call-button:hover { background: #00796b; transform: scale(1.05); }
        
        /* Call Modal Styling */
        .call-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 80%;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 10px;
            z-index: 9999; /* Ensures it's above everything */
        }
        
        .call-modal iframe { width: 100%; height: 90%; border: none; }
        .call-modal .close-button { position: absolute; top: 10px; right: 10px; background: #ff4d4d; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: bold; }
        .call-modal .close-button:hover { background: #cc0000; }
    </style>
    
    
</head>
<body>

    <div class="header">
        <div class="logo">
            <img src="static/AuraMedlogo.png" alt="AuraMed Logo" class="logo-img">
            <span class="logo-name">AuraMed</span>
        </div>
        <div class="details">
            <h1 id="hospital-name">Hospital Name</h1>
            <p><strong>Phone:</strong> <span id="phone">123-456-7890</span></p>
            <p><strong>Address:</strong> <span id="address">123 Main Street, City</span></p>
            <p><strong>Email:</strong> <span id="email">info@hospital.com</span></p>
            <button class="edit-btn" onclick="makeEditable()">Edit</button>
        </div>
        <form action="{{ url_for('logout') }}" method="POST" class="logout-form">
            <button type="submit" class="logout-btn">Logout</button>
        </form>
    </div>
    

    <div class="tabs">
        <button class="tab active" onclick="openTab('appointmentTest')">Appointments & Tests</button>
        <button class="tab" onclick="openTab('availableSlots')">Available Slots</button>
        <button class="tab" onclick="openTab('inventoryManagement')">Inventory</button>
        <button class="tab" onclick="openTab('callManagement')">Call Management</button>
    </div>
    
    <div id="appointmentTest" class="tab-content active">
    
        <h2>Appointments</h2>
<div class="table-container">
    <h3>Ongoing Appointments</h3>
    <table>
        <thead>
            <tr>
                <th>Patient Name</th>
                <th>Doctor Name</th>
                <th>Specialization</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="ongoing-appointments-table"></tbody>
    </table>

    <h3>Completed Appointments</h3>
    <table>
        <thead>
            <tr>
                <th>Patient Name</th>
                <th>Doctor Name</th>
                <th>Specialization</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="completed-appointments-table"></tbody>
    </table>
</div>

<h2>Tests</h2>
<div class="table-container">
    <h3>Ongoing Tests</h3>
    <table>
        <thead>
            <tr>
                <th>Patient Name</th>
                <th>Doctor Name</th>
                <th>Test Type</th>
                <th>Test ID</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="ongoing-tests-table"></tbody>
    </table>

    <h3>Completed Tests</h3>
    <table>
        <thead>
            <tr>
                <th>Patient Name</th>
                <th>Doctor Name</th>
                <th>Test Type</th>
                <th>Test ID</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="completed-tests-table"></tbody>
    </table>
</div>

</div>
    
    
    <!-- Available Slots Management -->
<div id="availableSlots" class="tab-content">
    <h2>Available Slots Management</h2>

    <!-- Doctor Slots -->
    <div id="doctorSlots">
        <h2>Doctors</h2>
        <button class="action-btn" onclick="openAddDoctorModal()">Add New Doctor</button>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Doctor Name</th>
                        <th>Specialization</th>
                        <th>Availability</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="doctors-table">
                    <tr>
                        <td>Dr. John Doe</td>
                        <td>Cardiology</td>
                        <td>9:00 AM - 5:00 PM</td>
                        <td>
                            <button class="action-btn" onclick="showUpdateModal('Dr. John Doe')">Update Availability</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Bed Slots -->
    <div id="bedSlots">
        <h2>Bed Availability</h2>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Bed Type</th>
                        <th>Available Beds</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="bed-availability-table">
                    <!-- Rows will be dynamically populated -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Test Slots -->
    <div id="testSlots">
        <h2>Test Slot Availability</h2>
        <label for="testCategoryFilter">Filter by Test Category:</label>
        <select id="testCategoryFilter" class="dropdown">
            <option value="" selected>All Categories</option>
            <option value="Blood Tests">Blood Tests</option>
            <option value="Prenatal and Pregnancy Tests">Prenatal and Pregnancy Tests</option>
            <!-- Add other categories -->
        </select>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Test Category</th>
                        <th>Test Name</th>
                        <th>Price</th>
                        <th>Date</th>
                        <th>Time Slots</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="test-availability-table">
                    <!-- Rows will be dynamically populated -->
                </tbody>
            </table>
        </div>
        <button class="action-btn" onclick="openModal()">Add/Update Slot</button>
    </div>
</div>


 <!-- Modal for Adding a New Doctor -->
 <div id="add-doctor-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <span class="close" onclick="closeAddDoctorModal()">&times;</span>
            <h3>Add New Doctor</h3>
        </div>
        <div class="modal-body">
            <form id="add-doctor-form">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required><br><br>

                <label for="specialization">Specialization:</label>
                <input type="text" id="specialization" name="specialization" required><br><br>

                <label for="phone_number">Phone Number:</label>
                <input type="text" id="phone_number" name="phone_number" required><br><br>

                <label for="hospital">Hospital:</label>
                <input type="text" id="hospital" name="hospital" required><br><br>

                <label for="availability">Availability:</label>
                <div id="availability-container">
                    <input type="date" id="availability-date" required>
                    <select id="availability-time">
                        <option value="08:00">08:00 AM</option>
                        <option value="09:00">09:00 AM</option>
                        <option value="10:00">10:00 AM</option>
                        <option value="11:00">11:00 AM</option>
                        <option value="14:00">02:00 PM</option>
                        <option value="15:30">03:30 PM</option>
                    </select>
                    <button type="button" onclick="addAvailability()">Add</button>
                </div>
                <ul id="availability-list"></ul><br><br>

                <label for="degrees">Degrees:</label>
                <input type="text" id="degrees" name="degrees" placeholder="Comma-separated (e.g., MBBS, MS)" required><br><br>

                <label for="experience">Experience:</label>
                <textarea id="experience" name="experience" placeholder="Enter experience details" required></textarea><br><br>

                <label for="achievements">Achievements:</label>
                <textarea id="achievements" name="achievements" placeholder="Comma-separated achievements" required></textarea><br><br>

                <button type="button" class="submit-btn" onclick="addDoctor()">Submit</button>
            </form>
        </div>
    </div>
</div>


<!-- Modal for adding/updating slots -->
<div class="modal" id="slotModal">
    <div class="modal-content">
        <div class="modal-header">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3>Update Test Slot</h3>
        </div>
        <div class="modal-body">
            <form id="slotForm">
                <label for="testCategory">Test Category:</label>
                <select id="testCategory" class="dropdown" required>
                    <option value="" disabled selected>Select Category</option>
                    <option value="Blood Tests">Blood Tests</option>
                    <option value="Prenatal and Pregnancy Tests">Prenatal and Pregnancy Tests</option>
                    <!-- Add other categories -->
                </select>

                <label for="testName">Test Name:</label>
                <input type="text" id="testName" required>

                <label for="testPrice">Price:</label>
                <input type="number" id="testPrice" min="0" required>

                <label for="testDate">Date:</label>
                <input type="date" id="testDate" required>

                <label for="testTime">Time:</label>
                <input type="time" id="testTime" required>

                <label for="slots">Number of Slots:</label>
                <input type="number" id="slots" min="1" required>

                <button type="submit" class="submit-btn">Save</button>
            </form>
        </div>
    </div>
</div>


    
    
        


     <!-- Modal -->
<div id="updateModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <span class="close" onclick="closeModaldoc()">&times;</span>
            <h2>Update Availability</h2>
        </div>
        <div class="modal-body">
            <label for="date">Choose Date:</label>
            <input type="date" id="date" class="dropdown">
            
            <label for="time-slot">Choose Time Slot:</label>
            <select id="time-slot" class="dropdown">
                <!-- 24-hour time slots -->
                <option value="00:00">00:00</option>
                <option value="01:00">01:00</option>
                <option value="02:00">02:00</option>
                <option value="03:00">03:00</option>
                <option value="04:00">04:00</option>
                <option value="05:00">05:00</option>
                <option value="06:00">06:00</option>
                <option value="07:00">07:00</option>
                <option value="08:00">08:00</option>
                <option value="09:00">09:00</option>
                <option value="10:00">10:00</option>
                <option value="11:00">11:00</option>
                <option value="12:00">12:00</option>
                <option value="13:00">13:00</option>
                <option value="14:00">14:00</option>
                <option value="15:00">15:00</option>
                <option value="16:00">16:00</option>
                <option value="17:00">17:00</option>
                <option value="18:00">18:00</option>
                <option value="19:00">19:00</option>
                <option value="20:00">20:00</option>
                <option value="21:00">21:00</option>
                <option value="22:00">22:00</option>
                <option value="23:00">23:00</option>
            </select>

            <label for="available-slots">Enter Number of Slots:</label>
            <input type="number" id="available-slots" placeholder="Enter number of slots" class="dropdown">
        </div>
        <div class="modal-footer">
            <button class="submit-btn" onclick="updateAvailability()">Submit</button>
        </div>
    </div>
</div>


<div id="inventoryManagement" class="tab-content">
    <h2>Hospital Inventory Management</h2>
    <button class="inv-add-item-btn" onclick="openInvModal()">Add Item</button>

    <h3>Medicines</h3>
    <input type="text" id="medicineSearch" class="search-input" placeholder="Search Medicines" onkeyup="searchTable('medicineTable', this.value)">
    <div class="table-container">
        <table id="medicineTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <h3>Equipment</h3>
    <input type="text" id="equipmentSearch" class="search-input" placeholder="Search Equipment" onkeyup="searchTable('equipmentTable', this.value)">
    <div class="table-container">
        <table id="equipmentTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<!-- Add/Edit Modal -->
<div id="inv-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeInvModal()">&times;</span>
        <h2 id="modalTitle">Add Item</h2>
        <label for="itemName">Name:</label>
        <input type="text" id="itemName" placeholder="Enter item name">

        <label for="itemCategory">Category:</label>
        <select id="itemCategory">
            <option value="Medicine">Medicine</option>
            <option value="Equipment">Equipment</option>
        </select>

        <label for="itemQuantity">Quantity:</label>
        <input type="number" id="itemQuantity" placeholder="Enter quantity">

        <label for="itemPrice">Price:</label>
        <input type="number" id="itemPrice" placeholder="Enter price">

        <button onclick="saveItem()" class="submit-btn">Save</button>
    </div>
</div>
<div id="callManagement" class="tab-content">
    <h2>Call Management</h2>
    <div class="call-management-container">
        <div class="meeting-section">
            <h3>Requests for Video Consultation</h3>
            <table>
                <thead>
                    <tr>
                        <th>Doctor Name</th>
                        <th>Patient Name</th>
                        <th>Specialization</th>
                        <th>Date & Time</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="video-consultation-requests"></tbody>
            </table>
        </div>

        <div class="meeting-section">
            <h3>Create Meeting Room</h3>
            <button onclick="openCreateRoomForm()">Create Room</button>
            <div id="createRoomForm" class="create-room-form">
                <label>Doctor Name: <input type="text"></label><br>
                <label>Patient Name: <input type="text"></label><br>
                <label>Date & Time: <input type="datetime-local"></label><br>
                <button onclick="openCallModal()">Start Meeting</button>
            </div>
        </div>

        <div class="meeting-section">
            <h3>Ongoing Meeting Rooms</h3>
            <table>
                <thead>
                    <tr>
                        <th>Doctor Name</th>
                        <th>Patient Name</th>
                        <th>Specialization</th>
                        <th>Date & Time</th>
                    </tr>
                </thead>
                <tbody id="ongoing-meeting-rooms"></tbody>
            </table>
        </div>

        <div class="meeting-section">
            <h3>Completed Meeting Rooms</h3>
            <table>
                <thead>
                    <tr>
                        <th>Doctor Name</th>
                        <th>Patient Name</th>
                        <th>Specialization</th>
                        <th>Date & Time</th>
                    </tr>
                </thead>
                <tbody id="completed-meeting-rooms"></tbody>
            </table>
        </div>
    </div>
</div>

<div id="callModal" class="call-modal">
    <iframe src="https://auramed-vc.onrender.com/"></iframe>
    <button onclick="closeCallModal()">Close</button>
</div>

    <script>


        function openTab(tabName) {
            let tabs = document.getElementsByClassName("tab-content");
            for (let tab of tabs) { tab.classList.remove("active"); }
            document.getElementById(tabName).classList.add("active");
            
            let tabButtons = document.getElementsByClassName("tab");
            for (let button of tabButtons) { button.classList.remove("active"); }
            document.querySelector(`[onclick="openTab('${tabName}')"]`).classList.add("active");
        }


        function makeEditable() {
            const phone = document.getElementById('phone');
            const address = document.getElementById('address');
            const email = document.getElementById('email');

            if (phone.isContentEditable) {
                phone.contentEditable = "false";
                address.contentEditable = "false";
                email.contentEditable = "false";
            } else {
                phone.contentEditable = "true";
                address.contentEditable = "true";
                email.contentEditable = "true";
                phone.focus();
            }
        }

        async function fetchHospitalDetails() {
            try {
                const response = await fetch('/get-hospital-details');
                const result = await response.json();
    
                if (result.success) {
                    const data = result.data;
    
                    document.getElementById('hospital-name').textContent = data.name || "Hospital Name";
                    document.getElementById('phone').textContent = data.phone || "N/A";
                    document.getElementById('address').textContent = data.address || "N/A";
                    document.getElementById('email').textContent = data.email || "N/A";
    
                    const profilePicture = document.getElementById('profile-picture');
                    if (data.profile_picture) {
                        profilePicture.src = data.profile_picture;
                        profilePicture.style.display = "block";
                    }
                } else {
                    alert(result.message);
                }
            } catch (error) {
                console.error("Error fetching hospital details:", error);
            }
        }
    
        // Call the function on page load
        window.onload = fetchHospitalDetails;


        function makeEditable() {
            document.getElementById('hospital-name').contentEditable = true;
            document.getElementById('phone').contentEditable = true;
            document.getElementById('address').contentEditable = true;
            document.getElementById('hospital-name').focus();
    
            const saveButton = document.createElement('button');
            saveButton.textContent = "Save";
            saveButton.onclick = saveHospitalDetails;
            document.querySelector('.details').appendChild(saveButton);
        }
    
        async function saveHospitalDetails() {
            const name = document.getElementById('hospital-name').textContent.trim();
            const phone = document.getElementById('phone').textContent.trim();
            const address = document.getElementById('address').textContent.trim();
    
            if (!name || !phone || !address) {
                alert("All fields are required!");
                return;
            }
    
            const formData = new FormData();
            formData.append('name', name);
            formData.append('phone', phone);
            formData.append('address', address);
    
            // Optionally, include profile picture if edited
            const profilePictureInput = document.getElementById('profile-picture-input');
            if (profilePictureInput && profilePictureInput.files[0]) {
                formData.append('profile_picture', profilePictureInput.files[0]);
            }
    
            try {
                const response = await fetch('/update-hospital-details', {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();
    
                if (result.success) {
                    alert(result.message);
                    location.reload(); // Reload to fetch updated data
                } else {
                    alert(result.message);
                }
            } catch (error) {
                console.error("Error updating hospital details:", error);
            }
        }


        document.addEventListener('DOMContentLoaded', () => {
            fetch('/get-doctors')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const doctorsTable = document.getElementById('doctors-table');
                        doctorsTable.innerHTML = ''; // Clear existing rows
        
                        data.data.forEach(doctor => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${doctor.name}</td>
                                <td>${doctor.specialization}</td>
                                <td>${Object.keys(doctor.availability).map(date => `
                                    <div>
                                        <strong>${date}:</strong>
                                        ${Object.entries(doctor.availability[date]).map(
                                            ([time, slots]) => `${time} (${slots} slots)`
                                        ).join(', ')}
                                    </div>
                                `).join('')}</td>
                                <td>
                                    <button class="action-btn" onclick="showUpdateModal('${doctor.name}')">Update</button>
                                </td>
                            `;
                            doctorsTable.appendChild(row);
                        });
                    } else {
                        alert(data.message);
                    }
                });
        });
        
        let currentDoctor = "";
        
        // Open the modal and set the doctor name
function showUpdateModal(doctorName) {
    currentDoctor = doctorName;
    document.getElementById('updateModal').style.display = 'block';
}

function closeModaldoc() {
    console.log('Close button clicked');
    document.getElementById('updateModal').style.display = 'none';
}

        
        // Update availability and submit the data
function updateAvailability() {
    const date = document.getElementById('date').value;
    const timeSlot = document.getElementById('time-slot').value;
    const availableSlots = document.getElementById('available-slots').value;

    if (!date || !timeSlot || !availableSlots) {
        alert("Please fill out all fields.");
        return;
    }

    fetch('/update-doctor-availability', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            name: currentDoctor,
            availability: {
                [date]: {
                    [timeSlot]: parseInt(availableSlots)
                }
            }
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert("Availability updated successfully!");
            location.reload(); // Refresh to show updated data
        } else {
            alert(data.message);
        }
    });

    closeModal();
}

// Close modal on outside click
window.onclick = function(event) {
    const modal = document.getElementById('updateModal');
    if (event.target === modal) {
        closeModal();
    }
};



document.addEventListener('DOMContentLoaded', () => {
    // Handle Appointments
    const ongoingAppointmentsTable = document.getElementById('ongoing-appointments-table');
    const completedAppointmentsTable = document.getElementById('completed-appointments-table');

    // Fetch and populate appointments table
fetch('/get_appointments')
.then(response => response.json())
.then(data => {
    ongoingAppointmentsTable.innerHTML = '';
    completedAppointmentsTable.innerHTML = '';

    // Sort appointments by `created_at` timestamp
    data.sort((a, b) => new Date(a.created_at) - new Date(b.created_at));

    data.forEach(appointment => {
        const ongoingRow = `
            <tr>
                <td>${appointment.patient_name}</td>
                <td>${appointment.doctor_name}</td>
                <td>${appointment.doctor_specialization}</td>
                <td>${appointment.status}</td>
                <td>
                    <button class="action-btn done-btn" data-id="${appointment.appointment_id}">Done</button>
                    <button class="action-btn upload-btn" data-id="${appointment.appointment_id}">Upload Prescription</button>
                </td>
            </tr>`;

        const completedRow = `
            <tr>
                <td>${appointment.patient_name}</td>
                <td>${appointment.doctor_name}</td>
                <td>${appointment.doctor_specialization}</td>
                <td>${appointment.status}</td>
            </tr>`;

        if (appointment.status === 'completed') {
            completedAppointmentsTable.insertAdjacentHTML('beforeend', completedRow);
        } else {
            ongoingAppointmentsTable.insertAdjacentHTML('beforeend', ongoingRow);
        }
    });
})
.catch(err => console.error('Failed to fetch appointments:', err));

ongoingAppointmentsTable.addEventListener('click', handleAppointmentActions);

const ongoingTestsTable = document.getElementById('ongoing-tests-table');
const completedTestsTable = document.getElementById('completed-tests-table');


// Fetch and populate tests table
fetch('/get_tests')
    .then(response => response.json())
    .then(data => {
        // Sort tests by booking_timestamp (earliest first)
        data.sort((a, b) => new Date(a.booking_timestamp) - new Date(b.booking_timestamp));
        
        ongoingTestsTable.innerHTML = '';
        completedTestsTable.innerHTML = '';
        data.forEach(test => {
            const ongoingRow = `
                <tr>
                    <td>${test.patient_name}</td>
                    <td>${test.hospital_name}</td>
                    <td>${test.test_type}</td>
                    <td>${test.test_slot_code}</td>
                    <td>${test.status}</td>
                    <td>
                        <button class="action-btn done-btn" data-id="${test.test_slot_code}">Done</button>
                        <button class="action-btn upload-btn" data-id="${test.test_slot_code}">Upload Report</button>
                    </td>
                </tr>`;

            const completedRow = `
                <tr>
                    <td>${test.patient_name}</td>
                    <td>${test.hospital_name}</td>
                    <td>${test.test_type}</td>
                    <td>${test.test_slot_code}</td>
                    <td>${test.status}</td>
                </tr>`;

            if (test.status === 'completed') {
                completedTestsTable.insertAdjacentHTML('beforeend', completedRow);
            } else {
                ongoingTestsTable.insertAdjacentHTML('beforeend', ongoingRow);
            }
        });
    })
    .catch(err => console.error('Failed to fetch tests:', err));

ongoingTestsTable.addEventListener('click', handleTestActions);

    // Handle Appointment Actions
    function handleAppointmentActions(e) {
        if (e.target.classList.contains('done-btn')) {
            const appointmentId = e.target.getAttribute('data-id');
            fetch('/update_status', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ appointment_id: appointmentId, status: 'completed' }),
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Appointment marked as completed!');
                        location.reload();
                    }
                })
                .catch(err => console.error('Error marking appointment as completed:', err));
        }

        if (e.target.classList.contains('upload-btn')) {
            const appointmentId = e.target.getAttribute('data-id');
            const formData = new FormData();
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.pdf';
            fileInput.onchange = () => {
                formData.append('appointment_id', appointmentId);
                formData.append('prescription', fileInput.files[0]);
                fetch('/upload_prescription', {
                    method: 'POST',
                    body: formData,
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert('Prescription uploaded successfully!');
                            location.reload();
                        }
                    })
                    .catch(err => console.error('Error uploading prescription:', err))
                    .finally(() => fileInput.remove());
            };
            fileInput.click();
        }
    }

    // Handle Test Actions
    function handleTestActions(e) {
        const target = e.target;
        const testSlotCode = target.dataset.id;

        if (target.classList.contains('done-btn')) {
            fetch('/update_status_test', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ test_slot_code: testSlotCode }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.message) { // Check for 'message' in the response
                    alert('Test marked as completed!');
                    location.reload();
                } else {
                    console.error('Error:', data.error);
                }
            })
            .catch(err => console.error('Error updating test status:', err));
        }
        

        if (target.classList.contains('upload-btn')) {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.pdf,.jpg,.png,.docx';

            fileInput.onchange = () => {
                const file = fileInput.files[0];
                if (!file) return;

                const formData = new FormData();
                formData.append('test_slot_code', testSlotCode);
                formData.append('file', file);

                fetch('/upload_report', {
                    method: 'POST',
                    body: formData,
                })
                    .then(response => response.json())
                    .then(data => alert(data.message))
                    .catch(err => console.error('Error uploading report:', err))
                    .finally(() => fileInput.remove());
            };

            fileInput.click();
        }
    }
});

 



        
        // Fetch bed availability data and populate the table
    fetch('/bed_availability')
    .then(response => response.json())
    .then(data => {
        const tableBody = document.getElementById('bed-availability-table');
        tableBody.innerHTML = '';

        data.forEach(bed => {
            const row = document.createElement('tr');

            row.innerHTML = `
                <td>${bed.type}</td>
                <td>${bed.available}</td>
                <td><button class="action-btn" onclick="updateBed('${bed.type}')">Update</button></td>
            `;

            tableBody.appendChild(row);
        });
    });

function updateBed(bedType) {
    const newAvailability = prompt(`Enter new availability for ${bedType}:`);
    if (newAvailability !== null) {
        fetch('/update_bed', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ type: bedType, available: parseInt(newAvailability) })
        }).then(response => {
            if (response.ok) {
                alert('Bed availability updated!');
                location.reload();
            } else {
                alert('Failed to update bed availability.');
            }
        });
    }
}
let availability = {};

    function openAddDoctorModal() {
        document.getElementById('add-doctor-modal').style.display = 'block';
    }

    function closeAddDoctorModal() {
        document.getElementById('add-doctor-modal').style.display = 'none';
    }

    function addAvailability() {
        const date = document.getElementById('availability-date').value;
        const time = document.getElementById('availability-time').value;

        if (!date || !time) {
            alert('Please select both a date and a time.');
            return;
        }

        if (!availability[date]) {
            availability[date] = [];
        }
        availability[date].push(time);

        updateAvailabilityList();
    }

    function updateAvailabilityList() {
        const list = document.getElementById('availability-list');
        list.innerHTML = '';
        for (const [date, times] of Object.entries(availability)) {
            const listItem = document.createElement('li');
            listItem.textContent = `${date}: ${times.join(', ')}`;
            list.appendChild(listItem);
        }
    }

    async function addDoctor() {
        const form = document.getElementById('add-doctor-form');
        const formData = new FormData(form);
        const doctorData = {};

        formData.forEach((value, key) => {
            if (key === 'degrees' || key === 'achievements') {
                doctorData[key] = value.split(',').map((item) => item.trim());
            } else if (key === 'experience') {
                doctorData[key] = value;
            } else {
                doctorData[key] = value;
            }
        });

        doctorData.availability = availability;

        const response = await fetch('/add-doctor', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(doctorData),
        });

        if (response.ok) {
            alert('Doctor added successfully!');
            closeAddDoctorModal();
            form.reset();
            availability = {};
            updateAvailabilityList();
        } else {
            alert('Failed to add doctor.');
        }
    }


    document.addEventListener("DOMContentLoaded", () => {
        const testAvailabilityTable = document.getElementById("test-availability-table");
        const slotModal = document.getElementById("slotModal");
        const slotForm = document.getElementById("slotForm");
        const testCategoryFilter = document.getElementById("testCategoryFilter");
    
        // Function to fetch and display test slots
        async function fetchTestSlots(filter = "") {
            const response = await fetch('/get_test_slots');
            const data = await response.json();
            testAvailabilityTable.innerHTML = "";
    
            for (const [category, tests] of Object.entries(data)) {
                if (filter && category !== filter) continue;
    
                for (const [testName, details] of Object.entries(tests)) {
                    const { price, ...dates } = details;
    
                    for (const [date, times] of Object.entries(dates)) {
                        for (const [time, slotDetails] of Object.entries(times)) {
                            const { slots } = slotDetails;
    
                            const row = `
                                <tr>
                                    <td>${category}</td>
                                    <td>${testName}</td>
                                    <td>${price}</td>
                                    <td>${date}</td>
                                    <td>${time} (${slots} slots)</td>
                                    <td>
                                        <button class="action-btn" onclick="editSlot('${category}', '${testName}', ${price}, '${date}', '${time}', ${slots})">Edit</button>
                                    </td>
                                </tr>
                            `;
                            testAvailabilityTable.innerHTML += row;
                        }
                    }
                }
            }
        }
    
        function openModal() {
            slotModal.style.display = "block";
        }
    
        function closeModal() {
            slotModal.style.display = "none";
        }
    
        function editSlot(category, testName, price, date, time, slots) {
            document.getElementById("testCategory").value = category;
            document.getElementById("testName").value = testName;
            document.getElementById("testPrice").value = price;
            document.getElementById("testDate").value = date;
            document.getElementById("testTime").value = time;
            document.getElementById("slots").value = slots;
            openModal();
        }
    
        slotForm.addEventListener("submit", async (event) => {
            event.preventDefault();
    
            const category = document.getElementById("testCategory").value;
            const testName = document.getElementById("testName").value;
            const price = document.getElementById("testPrice").value;
            const date = document.getElementById("testDate").value;
            const time = document.getElementById("testTime").value;
            const slots = document.getElementById("slots").value;
    
            const response = await fetch('/update_test_slot', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ category, testName, price, date, time, slots }),
            });
    
            if (response.ok) {
                alert("Slot updated successfully!");
                fetchTestSlots(testCategoryFilter.value);
                closeModal();
            } else {
                alert("Error updating slot.");
            }
        });
    
        testCategoryFilter.addEventListener("change", () => {
            fetchTestSlots(testCategoryFilter.value);
        });
    
        fetchTestSlots();
    
        window.openModal = openModal;
        window.closeModal = closeModal;
        window.editSlot = editSlot;
    });


    let inventory = [];
let editIndex = null;

// Fetch inventory data from Flask backend
async function fetchInventory() {
    try {
        const response = await fetch("/inventory/get_inventory");
        console.log("Response status:", response.status);
        console.log("Raw response:", response);

        if (!response.ok) {
            const errorData = await response.json();
            console.error("Error fetching inventory:", errorData.error || errorData.message);
            return;
        }

        const data = await response.json(); // Parse JSON
        console.log("Parsed data:", data);

        // Reset and populate inventory
        inventory = [];
        processInventoryResponse(data);

        console.log("Inventory after fetch:", inventory);
        renderTable(); // Render the table with updated inventory
    } catch (error) {
        console.error("Network error:", error);
    }
}

// Process the API response and populate inventory
function processInventoryResponse(data) {
    if (Array.isArray(data)) {
        data.forEach(item => {
            inventory.push({
                id: generateUniqueId(),
                name: item.name,
                category: item.category,
                quantity: item.quantity,
                price: item.price || "N/A" // Default price if missing
            });
        });
    } else {
        console.warn("Unexpected response format:", data);
    }
}

// Render the inventory table
function renderTable() {
    const tables = {
        Medicine: document.querySelector("#medicineTable tbody"),
        Equipment: document.querySelector("#equipmentTable tbody")
    };

    // Clear existing table rows
    Object.values(tables).forEach(tbody => (tbody.innerHTML = ""));

    inventory.forEach((item, index) => {
        const tableId = item.category;
        const tbody = tables[tableId];

        if (!tbody) {
            console.warn(`No table found for category: ${tableId}`);
            return;
        }

        // Create a new row
        const row = document.createElement("tr");
        row.id = item.id;

        row.innerHTML = `
            <td>${item.name}</td>
            <td>${item.quantity}</td>
            <td>${item.price}</td>
            <td>
                <button class="inv-edit-btn" onclick="openInvModal(${index})">Edit</button>
                <button class="inv-delete-btn" onclick="deleteItem(${index})">Delete</button>
            </td>
        `;

        console.log(`Appending row to ${tableId} table:`, row);
        tbody.appendChild(row);
    });

    // Log final table content for debugging
    console.log("Medicine Table HTML:", tables.Medicine.innerHTML);
    console.log("Equipment Table HTML:", tables.Equipment.innerHTML);
}


// Open modal for adding or editing items
function openInvModal(index = null) {
    document.getElementById("inv-modal").style.display = "block";
    document.getElementById("modalTitle").innerText = index === null ? "Add Item" : "Edit Item";

    if (index !== null) {
        editIndex = index;
        const item = inventory[index];
        document.getElementById("itemName").value = item.name;
        document.getElementById("itemCategory").value = item.category;
        document.getElementById("itemQuantity").value = item.quantity;
        document.getElementById("itemPrice").value = item.price;
    } else {
        editIndex = null;
        document.getElementById("itemName").value = "";
        document.getElementById("itemCategory").value = "Medicine";
        document.getElementById("itemQuantity").value = "";
        document.getElementById("itemPrice").value = "";
    }
}

function closeInvModal() {
    document.getElementById("inv-modal").style.display = "none";
}

// Generate unique ID for items
function generateUniqueId() {
    return 'item-' + new Date().getTime() + '-' + Math.floor(Math.random() * 1000);
}

// Save a new or edited item
async function saveItem() {
    const name = document.getElementById("itemName").value;
    const category = document.getElementById("itemCategory").value;
    const quantity = parseInt(document.getElementById("itemQuantity").value, 10);
    const price = document.getElementById("itemPrice").value;

    if (editIndex !== null) {
        inventory[editIndex] = { id: inventory[editIndex].id, name, category, quantity, price };
    } else {
        inventory.push({ id: generateUniqueId(), name, category, quantity, price });
    }

    await updateBackendInventory();
    closeInvModal();
    renderTable();
}

// Delete an item from the inventory
async function deleteItem(index) {
    inventory.splice(index, 1);
    await updateBackendInventory();
    renderTable();
}

// Update inventory data in the backend
async function updateBackendInventory() {
    try {
        const response = await fetch("/inventory/update_inventory", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ inventory })
        });

        const result = await response.json();

        if (!response.ok) {
            console.error("Error updating inventory:", result.error || result.message);
        }
    } catch (error) {
        console.error("Network error while updating inventory:", error);
    }
}
// Search table rows based on input
function searchTable(tableId, query) {
    const table = document.getElementById(tableId);
    const rows = table.getElementsByTagName("tr");
    const lowerQuery = query.toLowerCase();

    for (let i = 1; i < rows.length; i++) {
        const cells = rows[i].getElementsByTagName("td");
        let match = false;

        for (let j = 0; j < cells.length; j++) {
            if (cells[j].textContent.toLowerCase().includes(lowerQuery)) {
                match = true;
                break;
            }
        }

        rows[i].style.display = match ? "" : "none";
    }
}

// Add confirmation before deleting an item
async function deleteItem(index) {
    const confirmDelete = confirm("Are you sure you want to delete this item?");
    if (!confirmDelete) return;

    inventory.splice(index, 1);
    await updateBackendInventory();
    renderTable();
}
// Fetch and render inventory when the page loads
fetchInventory();

function openCreateRoomForm() {
    document.getElementById("createRoomForm").style.display = "block";
}
function openCallModal() {
    document.getElementById("callModal").style.display = "block";
}
function closeCallModal() {
    document.getElementById("callModal").style.display = "none";
}
document.addEventListener("DOMContentLoaded", () => {
    console.log("Document loaded. Fetching video calls...");

    fetch("/get_video_calls")
        .then((response) => {
            console.log("Response received from /get_video_calls:", response);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then((data) => {
            console.log("Data received from server:", data);
            if (data.success) {
                console.log("Populating video consultation requests...");
                populateTable("video-consultation-requests", data.requests, true);

                console.log("Populating ongoing meeting rooms...");
                populateTable("ongoing-meeting-rooms", data.ongoing, false);

                console.log("Populating completed meeting rooms...");
                populateTable("completed-meeting-rooms", data.completed, false);
            } else {
                console.error("Server returned success: false. Data:", data);
            }
        })
        .catch((error) => console.error("Error fetching video calls:", error));
});

function populateTable(tableId, items, includeActions) {
    console.log(`Populating table: ${tableId} with ${items.length} items`);
    const table = document.getElementById(tableId);

    if (!table) {
        console.error(`Table with ID ${tableId} not found.`);
        return;
    }

    table.innerHTML = ""; // Clear existing rows

    items.forEach((item, index) => {
        console.log(`Adding row ${index + 1} to table ${tableId}:`, item);
        const row = document.createElement("tr");

        row.innerHTML = `
            <td>${item.doctor_name}</td>
            <td>${item.patient_name}</td>
            <td>${item.specialization}</td>
            <td>${item.datetime || "N/A"}</td>
            ${
                includeActions
                    ? `<td>
                        <button class="approve-btn">Approve</button>
                        <button class="decline-btn">Decline</button>
                    </td>`
                    : "<td></td>"
            }
        `;

        table.appendChild(row);
    });

    console.log(`Finished populating table: ${tableId}`);
}


    </script>

</body>
</html>
